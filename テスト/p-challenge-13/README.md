# 課題 13

## 課題 2

### 問題 1

#### E2E テストのメリットとデメリットを挙げてください

メリット

- ユーザと同じようにブラウザを操作し、挙動が期待通りになっているかを確認することができる
- 自動化したテストでシステム全体のソースコードの振る舞いを確認できる
  - 機能改善やリファクタリングに対するハードルが下がる
- クロスブラウザテストや、デバイスとの互換性の問題を検知できる

デメリット

- 運用コストが高い
  - テスト用の環境を用意する必要があり、実行コストがかかる
    - ローカルでやる場合は別
- 実行が不安定
  - 細かい UI のテストを実装し、ちょっとした文言の変更等で落ちたりする
  - リアルな環境を用いるため、ネットワークの一時的な遅延や切断などによりテストが成功したり失敗したりすることがある
  - SPA など非同期に要素を追加・削除する場合に、要素が表示されていないうちにテストが進んで失敗したりすることがある
- 実行速度が遅い
  - 実際にサーバーやブラウザを起動するため、単機能のテストとは比べ物にならない時間がかかる

[E2E テスト: 導入の必要性・何を導入するのか](https://commerce-engineer.rakuten.careers/entry/tech/0031)  
[【E2E テスト実践ガイド】E2E テストの実施方法からおすすめツール、現場での実践ポイントまで詳しく解説](https://www.praha-inc.com/lab/posts/e2e-testing)  
[E2E テストの導入から学んだこと](https://qiita.com/mt0m/items/7e18d8802843d9f60d28)

#### テスト手法（単体、統合、E2E など）を選択する際、どのような基準で選ぶと良いでしょうか？

![pyramid_2x](https://user-images.githubusercontent.com/49358142/145782241-079a1b2a-8883-46a3-90f3-eac6eb0938a4.png)

> テスト ピラミッド。アプリのテストスイートに含める必要がある 3 つのテストカテゴリを示しています

図 1.1 Google のドキュメント「テストの基礎」からの引用

さらに、この図の説明を引用すると、次のとおり

> 図 1.1 に示すテストピラミッドは、3 つのテストカテゴリ（小規模、中規模、大規模）について、アプリで扱うべき程度を示しています。

> - `小規模テスト`は、1 つのクラスごとにアプリの動作を検証する単体テストです。
> - `中規模テスト`は、モジュール内のスタックレベルでのインタラクション、または関連するモジュール間のインタラクションを検証する統合テストです。
> - `大規模テスト`は、アプリの複数のモジュールにまたがってユーザーが経験する過程を検証するエンドツーエンド テストです。

> 小規模テストから大規模テストへとピラミッドの段階が上がるにつれて、各テストの再現性は向上しますが、実行時間と保守およびデバッグの労力が増大します。したがって、統合テストより単体テストを増やし、エンドツーエンド テストより統合テストを増やす必要があります。各カテゴリのテストの割合はアプリのユースケースに応じて異なりますが、一般的には、小規模テスト 70%、中規模テスト 20%、大規模テスト 10% の割合でテストを作成することをおすすめします

[引用: テストの基礎](https://developer.android.com/training/testing/fundamentals?hl=ja)

引用した図 1.1 の説明をまとめると、次のとおり

|                    | 比較                                         |
| :----------------- | :------------------------------------------- |
| 実行速度           | 単体テスト > 統合テスト > E2E テスト(速い順) |
| 再現性             | E2E テスト > 統合テスト > 単体テスト(高い順) |
| メンテナンスコスト | E2E テスト > 統合テスト > 単体テスト(高い順) |

テスト手法を選択する際、どのような基準で選ぶべきかという問題に直面したとき、テストピラミッドを基準で選ぶと良い。  
理想的には、70％の単体テスト、20％の統合テスト、10％の E2E テストの割合で作成するのが良い。

[参考: E2E テストの長所と短所](https://ranorex.techmatrix.jp/blog/2021/12/10/end-to-end-testing-pros-cons-benefits/)  
[参考: コンテキストベースの自動テスト：テストピラミッドの再考](https://ranorex.techmatrix.jp/blog/2020/07/17/rethinking-test-automation-pyramid/)

## 課題 3

### クイズ 1

E2E テストの利点として正しいのは、次のうちどれ？

1. 実際のシナリオに合わせてテスト環境を簡単に再構築することができる
2. サードパーティのコードを含め、アプリケーションの依存関係が正しく連携して動作することを検証できる
3. 実行速度が速くかつ、安定してテストを実行することができる

<details>
<summary>ヒント</summary>

[E2E テストの長所と短所](https://ranorex.techmatrix.jp/blog/2021/12/10/end-to-end-testing-pros-cons-benefits/)

</details>

### クイズ 2

E2E テストのライブラリでは無いのは、次のうちどれ？

1. Cypress
1. Selenium
1. Lighthouse
1. PlayWright

<details>
<summary>ヒント</summary>

[【E2E テスト実践ガイド】E2E テストの実施方法からおすすめツール、現場での実践ポイントまで詳しく解説](https://www.praha-inc.com/lab/posts/e2e-testing)

</details>

### クイズ 3

赤枠に入る言葉は何でしょう？

![Slide_-_6](https://user-images.githubusercontent.com/49358142/146232873-e064f9f6-c646-49cd-8e17-807ed842cda0.png)

<details>
<summary>ヒント</summary>

[保守・拡張をしやすいカプセル化した Cypress](https://future-architect.github.io/articles/20210428c/)

</details>
